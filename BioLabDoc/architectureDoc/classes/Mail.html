<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>biolabs-api documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">biolabs-api documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li>Mail</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/utils/Mail.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getGrapAPIToken">getGrapAPIToken</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#sendEmail">sendEmail</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#sendEmailGraphAPI">sendEmailGraphAPI</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>



            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getGrapAPIToken"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            getGrapAPIToken
                        </b>
                        <a href="#getGrapAPIToken"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getGrapAPIToken()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="13"
                            class="link-to-prism">src/utils/Mail.ts:13</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Description: This method will return the generated Access token for send mail</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sendEmail"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            sendEmail
                        </b>
                        <a href="#sendEmail"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sendEmail(tenant: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, subject: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, content: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, userInfo: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="446"
                            class="link-to-prism">src/utils/Mail.ts:446</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Description: This method will send mail</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>tenant</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>subject</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>content</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userInfo</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sendEmailGraphAPI"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            sendEmailGraphAPI
                        </b>
                        <a href="#sendEmailGraphAPI"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sendEmailGraphAPI(tenant: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, token: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, subject: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, content: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, userInfo: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="41"
                            class="link-to-prism">src/utils/Mail.ts:41</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>tenant</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>token</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>subject</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>content</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userInfo</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { EMAIL } from &#x27;../constants/email&#x27;;

const dotenv &#x3D; require(&#x27;dotenv&#x27;);
const axios &#x3D; require(&#x27;axios&#x27;);
const qs &#x3D; require(&#x27;qs&#x27;);
dotenv.config();

export class Mail {
   /**
    * Description: This method will return the generated Access token for send mail
    * @description This method will return the generated Access token for send mail
    */
   async getGrapAPIToken() {
      const data &#x3D; qs.stringify({
         client_id: process.env.APPSETTING_MICROSOFT_EMAIL_APP_ID,
         scope: process.env.APPSETTING_MICROSOFT_EMAIL_GRAPH_SCOPE,
         client_secret: process.env.APPSETTING_MICROSOFT_EMAIL_APP_SECERET,
         grant_type: &#x27;client_credentials&#x27;,
      });
      let config &#x3D; {
         method: &#x27;post&#x27;,
         url: process.env.APPSETTING_MICROSOFT_EMAIL_ENDPOINT_TOKEN,
         headers: {
            &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;,
            Cookie:
               &#x27;x-ms-gateway-slice&#x3D;estsfd; stsservicecookie&#x3D;estsfd; fpc&#x3D;Atq01SXesc5AnxuS4qWIT5HOk_SAAQAAAF9QE9gOAAAA&#x27;,
         },
         data: data,
      };

      return await axios(config)
         .then(function (response) {
            return response.data;
         })
         .catch(function (error) {
            if (error)
              return;
         });
   }

   private sendEmailGraphAPI(tenant: any, token: any, subject: string, content: string, userInfo: any) {
      let userTxt &#x3D; tenant &amp;&amp; tenant.role &amp;&amp; tenant.role &#x3D;&#x3D; 3 ? &#x27;Insight&#x27; : &#x27;Connect&#x27;;

      let data;
      if (content &#x3D;&#x3D; &#x27;forgotMail&#x27;) {
         data &#x3D; {
            message: {
               subject: subject,
               body: {
                  contentType: EMAIL.CONTENT_TYPE,
                  content: &#x60;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
                        &lt;html xmlns&#x3D;&quot;http://www.w3.org/1999/xhtml&quot; xmlns:o&#x3D;&quot;urn:schemas-microsoft-com:office:office&quot; style&#x3D;&quot;width:100%;font-family:arial, &#x27;helvetica neue&#x27;, helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0&quot;&gt;
                           &lt;head&gt;
                              &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;
                              &lt;meta content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot; name&#x3D;&quot;viewport&quot;&gt;
                              &lt;meta name&#x3D;&quot;x-apple-disable-message-reformatting&quot;&gt;
                              &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;
                              &lt;meta content&#x3D;&quot;telephone&#x3D;no&quot; name&#x3D;&quot;format-detection&quot;&gt;
                              &lt;title&gt;New email&lt;/title&gt;
                              &lt;!--[if (mso 16)]&gt;
                              &lt;style type&#x3D;&quot;text/css&quot;&gt;
                                 a {text-decoration: none;}
                              &lt;/style&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if gte mso 9]&gt;
                              &lt;style&gt;sup { font-size: 100% !important; }&lt;/style&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if gte mso 9]&gt;
                              &lt;xml&gt;
                                 &lt;o:OfficeDocumentSettings&gt;
                                    &lt;o:AllowPNG&gt;&lt;/o:AllowPNG&gt;
                                    &lt;o:PixelsPerInch&gt;96&lt;/o:PixelsPerInch&gt;
                                 &lt;/o:OfficeDocumentSettings&gt;
                              &lt;/xml&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if !mso]&gt;&lt;!-- --&gt; 
                              &lt;link href&#x3D;&quot;https://fonts.googleapis.com/css?family&#x3D;Lato:400,400i,700,700i&quot; rel&#x3D;&quot;stylesheet&quot;&gt;
                              &lt;!--&lt;![endif]--&gt; 
                              &lt;style type&#x3D;&quot;text/css&quot;&gt;
                                 #outlook a {
                                 padding:0;
                                 }
                                 .ExternalClass {
                                 width:100%;
                                 }
                                 .ExternalClass,
                                 .ExternalClass p,
                                 .ExternalClass span,
                                 .ExternalClass font,
                                 .ExternalClass td,
                                 .ExternalClass div {
                                 line-height:100%;
                                 }
                                 .es-button {
                                 mso-style-priority:100!important;
                                 text-decoration:none!important;
                                 }
                                 a[x-apple-data-detectors] {
                                 color:inherit!important;
                                 text-decoration:none!important;
                                 font-size:inherit!important;
                                 font-family:inherit!important;
                                 font-weight:inherit!important;
                                 line-height:inherit!important;
                                 }
                                 .es-desk-hidden {
                                 display:none;
                                 float:left;
                                 overflow:hidden;
                                 width:0;
                                 max-height:0;
                                 line-height:0;
                                 mso-hide:all;
                                 }
                                 .es-button-border:hover a.es-button {
                                 background:#3533c6!important;
                                 border-color:#3533c6!important;
                                 }
                                 td .es-button-border:hover a.es-button-1 {
                                 background:#405a72!important;
                                 border-color:#405a72!important;
                                 }
                                 td .es-button-border-2:hover {
                                 background:#405a72!important;
                                 }
                                 td .es-button-border-3:hover {
                                 border-style:solid solid solid solid!important;
                                 background:#3533c6!important;
                                 border-color:#3533c6 #3533c6 #3533c6 #3533c6!important;
                                 }
                                 @media only screen and (max-width:600px) {p, ul li, ol li, a { font-size:16px!important; line-height:150%!important } h1 { font-size:30px!important; text-align:center; line-height:120%!important } h2 { font-size:26px!important; text-align:center; line-height:120%!important } h3 { font-size:20px!important; text-align:center; line-height:120%!important } h1 a { font-size:30px!important } h2 a { font-size:26px!important } h3 a { font-size:20px!important } .es-menu td a { font-size:16px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:16px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:16px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class&#x3D;&quot;gmail-fix&quot;] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button { font-size:20px!important; display:block!important; border-width:10px 0px 10px 0px!important } .es-btn-fw { border-width:10px 0px!important; text-align:center!important } .es-adaptive table, .es-btn-fw, .es-btn-fw-brdr, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } }
                              &lt;/style&gt;
                           &lt;/head&gt;
                           &lt;body style&#x3D;&quot;width:100%;font-family:arial, &#x27;helvetica neue&#x27;, helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0&quot;&gt;
                              &lt;div class&#x3D;&quot;es-wrapper-color&quot; style&#x3D;&quot;background-color:#F6F6F6&quot;&gt;
                                 &lt;!--[if gte mso 9]&gt;
                                 &lt;v:background xmlns:v&#x3D;&quot;urn:schemas-microsoft-com:vml&quot; fill&#x3D;&quot;t&quot;&gt;
                                    &lt;v:fill type&#x3D;&quot;tile&quot; color&#x3D;&quot;#f6f6f6&quot;&gt;&lt;/v:fill&gt;
                                 &lt;/v:background&gt;
                                 &lt;![endif]--&gt; 
                                 &lt;table class&#x3D;&quot;es-wrapper&quot; width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top&quot;&gt;
                                    &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                       &lt;td valign&#x3D;&quot;top&quot; style&#x3D;&quot;padding:0;Margin:0&quot;&gt;
                                          &lt;table class&#x3D;&quot;es-content&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%&quot;&gt;
                                             &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                &lt;td align&#x3D;&quot;center&quot; style&#x3D;&quot;padding:0;Margin:0&quot;&gt;
                                                   &lt;table class&#x3D;&quot;es-content-body&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; bgcolor&#x3D;&quot;#ffffff&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px&quot;&gt;
                                                      &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                         &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#F1F0EF&quot; style&#x3D;&quot;padding:35px;Margin:0;background-color:#F1F0EF&quot;&gt;
                                                            &lt;table width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px&quot;&gt;
                                                               &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                  &lt;td valign&#x3D;&quot;top&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;padding:0;Margin:0;width:530px&quot;&gt;
                                                                     &lt;table width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; role&#x3D;&quot;presentation&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px&quot;&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;padding:0;Margin:0;padding-left:30px;padding-right:30px;padding-top:35px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:32px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:64px;color:#000000;border-bottom:1px solid #E6E4E2&quot;&gt;&lt;strong&gt;Reset your Password&lt;/strong&gt;&amp;nbsp;&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;Hi ${userInfo.userName
                     },&lt;br&gt;&lt;br&gt;We&#x27;ve received your request to set a new password for your BioLabs ${userTxt} account. Click below button to reset your password.&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;center&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;padding:0;Margin:0;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;!--[if mso]&gt;
                                                                              &lt;a href&#x3D;&quot;&quot; target&#x3D;&quot;_blank&quot;&gt;
                                                                                 &lt;v:roundrect xmlns:v&#x3D;&quot;urn:schemas-microsoft-com:vml&quot; xmlns:w&#x3D;&quot;urn:schemas-microsoft-com:office:word&quot; stripoVmlButton href&#x3D;&quot;&quot; 
                                                                                    style&#x3D;&quot;height:49px;v-text-anchor:middle;width:469px;&quot; arcsize&#x3D;&quot;6%&quot; strokecolor&#x3D;&quot;#0f9792&quot; fillcolor&#x3D;&quot;#0f9792&quot;&gt;
                                                                                    &lt;w:anchorlock&gt;&lt;/w:anchorlock&gt;
                                                                                    &lt;center style&#x3D;&#x27;color:#ffffff;font-family:lato, &quot;helvetica neue&quot;, helvetica, arial, sans-serif;font-size:16px;font-weight:400;&#x27;&gt;&lt;b style&#x3D;&quot;color:white;&quot;&gt;Reset your Password&lt;/b&gt;&lt;/center&gt;
                                                                                 &lt;/v:roundrect&gt;
                                                                              &lt;/a&gt;
                                                                              &lt;![endif]--&gt; 
                                                                              &lt;!--[if !mso]&gt;&lt;!-- --&gt;&lt;span class&#x3D;&quot;msohide es-button-border es-button-border-3&quot; style&#x3D;&quot;border-style:solid;border-color:#0f9792;background:#0f9792;border-width:1px;display:block;border-radius:3px;width:auto;mso-hide:all&quot;&gt;&lt;a href&#x3D;&quot;${userInfo.origin +
                     EMAIL.EMAIL_CONFIRM_URL +
                     userInfo.token
                     }&quot; class&#x3D;&quot;es-button msohide&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;font-size:16px;color:#FFFFFF;border-style:solid;border-color:#0f9792;border-width:15px 20px;display:block;background:#0f9792;border-radius:3px;font-weight:normal;font-style:normal;line-height:19px;width:auto;text-align:center;mso-hide:all&quot;&gt;Reset your Password&lt;/a&gt;&lt;/span&gt; 
                                                                              &lt;!--&lt;![endif]--&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                        &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                        &lt;p href&#x3D;&quot;&quot; class&#x3D;&quot;es-button msohide&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;Or click on:  &lt;a href&#x3D;&quot;${userInfo.origin +
                     EMAIL.EMAIL_CONFIRM_URL +
                     userInfo.token
                     }&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:11px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:20px;color:#167efb;word-break: break-all;&quot;&gt;${userInfo.origin + EMAIL.EMAIL_CONFIRM_URL + userInfo.token
                     }&lt;/a&gt; &lt;/p&gt;
                                                                     &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;center&quot; bgcolor&#x3D;&quot;#fff&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;&lt;br&gt;&lt;span style&#x3D;&quot;font-size:14px;line-height:21px&quot;&gt;&lt;/span&gt;If you didn&#x27;t request this, you can safely ignore this email.&lt;br&gt;&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;center&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;&lt;br&gt;©&amp;nbsp;&lt;span style&#x3D;&quot;font-size:14px;line-height:21px&quot;&gt;&lt;/span&gt;2021 BioLabs&lt;br&gt;&lt;span style&#x3D;&quot;font-size:10px&quot;&gt;ALL RIGHTS RESERVED&lt;/span&gt;&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                     &lt;/table&gt;
                                                                  &lt;/td&gt;
                                                               &lt;/tr&gt;
                                                            &lt;/table&gt;
                                                         &lt;/td&gt;
                                                      &lt;/tr&gt;
                                                   &lt;/table&gt;
                                                &lt;/td&gt;
                                             &lt;/tr&gt;
                                          &lt;/table&gt;
                                       &lt;/td&gt;
                                    &lt;/tr&gt;
                                 &lt;/table&gt;
                              &lt;/div&gt;
                           &lt;/body&gt;
                        &lt;/html&gt;&#x60;,
               },
               toRecipients: [
                  {
                     emailAddress: {
                        address: tenant.tenantEmail
                           ? tenant.tenantEmail
                           : tenant.officialEmail,
                     },
                  },
               ],
               ccRecipients: [],
            },
         };
         if (EMAIL.CC_EMAIL_USER) {
            data.message.ccRecipients.push({
               emailAddress: {
                  address: EMAIL.CC_EMAIL_USER,
               },
            });
         }
      } else if (content &#x3D;&#x3D; &#x27;Invite&#x27;) {
         data &#x3D; {
            message: {
               subject: subject,
               body: {
                  contentType: EMAIL.CONTENT_TYPE,
                  content: &#x60;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
                        &lt;html xmlns&#x3D;&quot;http://www.w3.org/1999/xhtml&quot; xmlns:o&#x3D;&quot;urn:schemas-microsoft-com:office:office&quot; style&#x3D;&quot;width:100%;font-family:arial, &#x27;helvetica neue&#x27;, helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0&quot;&gt;
                           &lt;head&gt;
                              &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;
                              &lt;meta content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot; name&#x3D;&quot;viewport&quot;&gt;
                              &lt;meta name&#x3D;&quot;x-apple-disable-message-reformatting&quot;&gt;
                              &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;
                              &lt;meta content&#x3D;&quot;telephone&#x3D;no&quot; name&#x3D;&quot;format-detection&quot;&gt;
                              &lt;title&gt;New email&lt;/title&gt;
                              &lt;!--[if (mso 16)]&gt;
                              &lt;style type&#x3D;&quot;text/css&quot;&gt;
                                 a {text-decoration: none;}
                              &lt;/style&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if gte mso 9]&gt;
                              &lt;style&gt;sup { font-size: 100% !important; }&lt;/style&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if gte mso 9]&gt;
                              &lt;xml&gt;
                                 &lt;o:OfficeDocumentSettings&gt;
                                    &lt;o:AllowPNG&gt;&lt;/o:AllowPNG&gt;
                                    &lt;o:PixelsPerInch&gt;96&lt;/o:PixelsPerInch&gt;
                                 &lt;/o:OfficeDocumentSettings&gt;
                              &lt;/xml&gt;
                              &lt;![endif]--&gt; 
                              &lt;!--[if !mso]&gt;&lt;!-- --&gt; 
                              &lt;link href&#x3D;&quot;https://fonts.googleapis.com/css?family&#x3D;Lato:400,400i,700,700i&quot; rel&#x3D;&quot;stylesheet&quot;&gt;
                              &lt;!--&lt;![endif]--&gt; 
                              &lt;style type&#x3D;&quot;text/css&quot;&gt;
                                 #outlook a {
                                 padding:0;
                                 }
                                 .ExternalClass {
                                 width:100%;
                                 }
                                 .ExternalClass,
                                 .ExternalClass p,
                                 .ExternalClass span,
                                 .ExternalClass font,
                                 .ExternalClass td,
                                 .ExternalClass div {
                                 line-height:100%;
                                 }
                                 .es-button {
                                 mso-style-priority:100!important;
                                 text-decoration:none!important;
                                 }
                                 a[x-apple-data-detectors] {
                                 color:inherit!important;
                                 text-decoration:none!important;
                                 font-size:inherit!important;
                                 font-family:inherit!important;
                                 font-weight:inherit!important;
                                 line-height:inherit!important;
                                 }
                                 .es-desk-hidden {
                                 display:none;
                                 float:left;
                                 overflow:hidden;
                                 width:0;
                                 max-height:0;
                                 line-height:0;
                                 mso-hide:all;
                                 }
                                 .es-button-border:hover a.es-button {
                                 background:#3533c6!important;
                                 border-color:#3533c6!important;
                                 }
                                 td .es-button-border:hover a.es-button-1 {
                                 background:#405a72!important;
                                 border-color:#405a72!important;
                                 }
                                 td .es-button-border-2:hover {
                                 background:#405a72!important;
                                 }
                                 td .es-button-border-3:hover {
                                 border-style:solid solid solid solid!important;
                                 background:#3533c6!important;
                                 border-color:#3533c6 #3533c6 #3533c6 #3533c6!important;
                                 }
                                 @media only screen and (max-width:600px) {p, ul li, ol li, a { font-size:16px!important; line-height:150%!important } h1 { font-size:30px!important; text-align:center; line-height:120%!important } h2 { font-size:26px!important; text-align:center; line-height:120%!important } h3 { font-size:20px!important; text-align:center; line-height:120%!important } h1 a { font-size:30px!important } h2 a { font-size:26px!important } h3 a { font-size:20px!important } .es-menu td a { font-size:16px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:16px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:16px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class&#x3D;&quot;gmail-fix&quot;] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button { font-size:20px!important; display:block!important; border-width:10px 0px 10px 0px!important } .es-btn-fw { border-width:10px 0px!important; text-align:center!important } .es-adaptive table, .es-btn-fw, .es-btn-fw-brdr, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } }
                              &lt;/style&gt;
                           &lt;/head&gt;
                           &lt;body style&#x3D;&quot;width:100%;font-family:arial, &#x27;helvetica neue&#x27;, helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0&quot;&gt;
                              &lt;div class&#x3D;&quot;es-wrapper-color&quot; style&#x3D;&quot;background-color:#F6F6F6&quot;&gt;
                                 &lt;!--[if gte mso 9]&gt;
                                 &lt;v:background xmlns:v&#x3D;&quot;urn:schemas-microsoft-com:vml&quot; fill&#x3D;&quot;t&quot;&gt;
                                    &lt;v:fill type&#x3D;&quot;tile&quot; color&#x3D;&quot;#f6f6f6&quot;&gt;&lt;/v:fill&gt;
                                 &lt;/v:background&gt;
                                 &lt;![endif]--&gt; 
                                 &lt;table class&#x3D;&quot;es-wrapper&quot; width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top&quot;&gt;
                                    &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                       &lt;td valign&#x3D;&quot;top&quot; style&#x3D;&quot;padding:0;Margin:0&quot;&gt;
                                          &lt;table class&#x3D;&quot;es-content&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%&quot;&gt;
                                             &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                &lt;td align&#x3D;&quot;center&quot; style&#x3D;&quot;padding:0;Margin:0&quot;&gt;
                                                   &lt;table class&#x3D;&quot;es-content-body&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; bgcolor&#x3D;&quot;#ffffff&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px&quot;&gt;
                                                      &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                         &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#F1F0EF&quot; style&#x3D;&quot;padding:35px;Margin:0;background-color:#F1F0EF&quot;&gt;
                                                            &lt;table width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px&quot;&gt;
                                                               &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                  &lt;td valign&#x3D;&quot;top&quot; align&#x3D;&quot;center&quot; style&#x3D;&quot;padding:0;Margin:0;width:530px&quot;&gt;
                                                                     &lt;table width&#x3D;&quot;100%&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot; role&#x3D;&quot;presentation&quot; style&#x3D;&quot;mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px&quot;&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;padding:0;Margin:0;padding-left:30px;padding-right:30px;padding-top:35px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:32px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:64px;color:#000000;border-bottom:1px solid #E6E4E2&quot;&gt;&lt;strong&gt;Verify your email address&lt;/strong&gt;&amp;nbsp;&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;Hi ${userInfo.userName
                                                                              },&lt;br&gt;&lt;br&gt;Welcome to BioLabs Connect!&lt;br&gt;&lt;br&gt;Your account has been created and is ready for use. Please click the button below to set your password and get going.&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;center&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;padding:0;Margin:0;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;!--[if mso]&gt;
                                                                              &lt;a href&#x3D;&quot;&quot; target&#x3D;&quot;_blank&quot;&gt;
                                                                                 &lt;v:roundrect xmlns:v&#x3D;&quot;urn:schemas-microsoft-com:vml&quot; xmlns:w&#x3D;&quot;urn:schemas-microsoft-com:office:word&quot; stripoVmlButton href&#x3D;&quot;&quot; 
                                                                                    style&#x3D;&quot;height:49px;v-text-anchor:middle;width:469px;&quot; arcsize&#x3D;&quot;6%&quot; strokecolor&#x3D;&quot;#0f9792&quot; fillcolor&#x3D;&quot;#0f9792&quot;&gt;
                                                                                    &lt;w:anchorlock&gt;&lt;/w:anchorlock&gt;
                                                                                    &lt;center style&#x3D;&#x27;color:#ffffff;font-family:lato, &quot;helvetica neue&quot;, helvetica, arial, sans-serif;font-size:16px;font-weight:400;&#x27;&gt;&lt;b style&#x3D;&quot;color:white;&quot;&gt;Set your Password&lt;/b&gt;&lt;/center&gt;
                                                                                 &lt;/v:roundrect&gt;
                                                                              &lt;/a&gt;
                                                                              &lt;![endif]--&gt; 
                                                                              &lt;!--[if !mso]&gt;&lt;!-- --&gt;&lt;span class&#x3D;&quot;msohide es-button-border es-button-border-3&quot; style&#x3D;&quot;border-style:solid;border-color:#0f9792;background:#0f9792;border-width:1px;display:block;border-radius:3px;width:auto;mso-hide:all&quot;&gt;&lt;a href&#x3D;&quot;${userInfo.origin +
                     EMAIL.EMAIL_CONFIRM_URL +
                     userInfo.token
                     }&quot; class&#x3D;&quot;es-button msohide&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;font-size:16px;color:#FFFFFF;border-style:solid;border-color:#0f9792;border-width:15px 20px;display:block;background:#0f9792;border-radius:3px;font-weight:normal;font-style:normal;line-height:19px;width:auto;text-align:center;mso-hide:all&quot;&gt;Set your Password&lt;/a&gt;&lt;/span&gt; 
                                                                              &lt;!--&lt;![endif]--&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                        &lt;td align&#x3D;&quot;left&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                        &lt;p href&#x3D;&quot;&quot; class&#x3D;&quot;es-button msohide&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;Or click on:  &lt;a href&#x3D;&quot;${userInfo.origin +
                     EMAIL.EMAIL_CONFIRM_URL +
                     userInfo.token
                     }&quot; target&#x3D;&quot;_blank&quot; style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:11px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:20px;color:#167efb;word-break: break-all;&quot;&gt;${userInfo.origin + EMAIL.EMAIL_CONFIRM_URL + userInfo.token
                     }&lt;/a&gt; &lt;/p&gt;
                                                                     &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                        &lt;tr style&#x3D;&quot;border-collapse:collapse&quot;&gt;
                                                                           &lt;td align&#x3D;&quot;center&quot; bgcolor&#x3D;&quot;#fff&quot; style&#x3D;&quot;Margin:0;padding-top:20px;padding-bottom:20px;padding-left:30px;padding-right:30px&quot;&gt;
                                                                              &lt;p style&#x3D;&quot;Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:lato, &#x27;helvetica neue&#x27;, helvetica, arial, sans-serif;line-height:24px;color:#000000&quot;&gt;&lt;br&gt;©&amp;nbsp;&lt;span style&#x3D;&quot;font-size:14px;line-height:21px&quot;&gt;&lt;/span&gt;2021 BioLabs&lt;br&gt;&lt;span style&#x3D;&quot;font-size:10px&quot;&gt;ALL RIGHTS RESERVED&lt;/span&gt;&lt;/p&gt;
                                                                           &lt;/td&gt;
                                                                        &lt;/tr&gt;
                                                                     &lt;/table&gt;
                                                                  &lt;/td&gt;
                                                               &lt;/tr&gt;
                                                            &lt;/table&gt;
                                                         &lt;/td&gt;
                                                      &lt;/tr&gt;
                                                   &lt;/table&gt;
                                                &lt;/td&gt;
                                             &lt;/tr&gt;
                                          &lt;/table&gt;
                                       &lt;/td&gt;
                                    &lt;/tr&gt;
                                 &lt;/table&gt;
                              &lt;/div&gt;
                           &lt;/body&gt;
                        &lt;/html&gt;&#x60;,
               },
               toRecipients: [
                  {
                     emailAddress: {
                        address: tenant.tenantEmail
                           ? tenant.tenantEmail
                           : tenant.officialEmail,
                     },
                  },
               ],
               ccRecipients: [],
            },
         };
         if (EMAIL.CC_EMAIL_USER) {
            data.message.ccRecipients.push({
               emailAddress: {
                  address: EMAIL.CC_EMAIL_USER,
               },
            });
         }
      }

      let authToken &#x3D; token[&#x27;token_type&#x27;] + &#x27; &#x27; + token[&#x27;access_token&#x27;];
      axios.defaults.headers.post[&#x27;Content-Type&#x27;] &#x3D; &#x27;application/x-www-form-urlencoded&#x27;;
      axios.defaults.headers.post[&#x27;Authorization&#x27;] &#x3D; authToken;
      axios.post(process.env.APPSETTING_MICROSOFT_EMAIL_ENDPOINT_MAIL, data)
         .then((response) &#x3D;&gt; {
            return response.data;
         })
         .catch((error) &#x3D;&gt; {
            return error;
         });
   }

   /**
    * Description: This method will send mail
    * @description This method will send mail
    */
   async sendEmail(tenant: any, subject: string, content: string, userInfo: any) {
      /** Graph API Token Generation implementation */
      const tokenGraphAPI &#x3D; await this.getGrapAPIToken();

      /** Graph API Send Email implementation */
      this.sendEmailGraphAPI(tenant, tokenGraphAPI, subject, content, userInfo);
   }
}</code></pre>
    </div>
</div>



                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'Mail.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
